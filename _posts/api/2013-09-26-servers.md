---
layout: post
title:  "Servers API"
date:   2013-09-24 10:51:22
categories: API
---

<p class="lead">List Servers, their status and vital signs through the API</p>

## Listing Servers
#### Endpoint
<p><kbd>/stacks/[stack&#95;uid]/server&#95;groups/[svg&#95;id]/servers.json</kbd></p>
#### Method
GET
#### Required Scope
public
#### Description
Lists all the servers in a server group.
### Results
JSON array of all server groups belonging to the given stack.
Each item in the array contains the following attributes:
<table class="table table-bordered table-striped">
	<thead>
		<tr>
			<th>Attribute</th>
			<th>Value</th>
			<th>Comments</th>
		</tr>
  </thead>
	<tbody>
		<tr><td>uid</td><td>Server uid</td><td></td></tr>
		<tr><td>vendor&#95;uid</td><td>Unique id used by the cloud vendor</td><td>BYOC only</td></tr>
		<tr><td>name</td><td>Server name</td><td></td></tr>
		<tr><td>address</td><td>Server address</td><td>This is the original server address given by the cloud vendor</td></tr>
		<tr><td>distro</td><td>Linux distro</td><td>Only ubuntu for now</td></tr>
		<tr><td>distro&#95;version</td><td>Linux distro version</td><td>Only 12.04 for now</td></tr>
		<tr><td>dns&#95;record</td><td>Server DNS record</td><td>Full c66.me dns record address</td></tr>
		<tr><td>user&#95;name</td><td>User name</td><td></td></tr>
		<tr><td>has&#95;agent</td><td>Does this server have an agent</td><td></td></tr>
		<tr><td>server&#95;group&#95;id</td><td>Server Group ID</td><td></td></tr>
		<tr><td>stack&#95;uid</td><td>Stack UID</td><td></td></tr>
		<tr><td>server&#95;type</td><td>Server Type</td><td>BYOS or "Cloud (vendor name)"</td></tr>
		<tr><td>params</td><td>Extra server parameters</td><td>See below</td></tr>
		<tr><td>created&#95;at</td><td>Record created at</td><td>Date Time in UTC</td></tr>
		<tr><td>updated&#95;at</td><td>Record updated at</td><td>Date Time in UTC</td></tr>
	</tbody>
</table>

##### Server Parameters

JSON object containing:
<table class="table table-bordered table-striped">
	<thead>
		<tr>
			<th>Attribute</th>
			<th>Value</th>
			<th>Comments</th>
		</tr>
  </thead>
	<tbody>
		<tr><td>size&#95;id</td><td>Server size id</td><td><a href="/help/instance_names">Server Sizes</a></td></tr>
		<tr><td>ips</td><td>All server IP addresses</td><td>JSON array of all IP addresses of the server</td></tr>
		<tr><td>aws&#95;security&#95;group</td><td>AWS Security group name</td><td>AWS Only</td></tr>
		<tr><td>region</td><td>Cloud vendor region</td><td><a href="/help/instance_regions">Region names</a></td></tr>
		<tr><td>availability&#95;zone</td><td>Cloud vendor availablity zone</td><td>AWS Only</td><td></td></tr>
	</tbody>
</table>

## Show Server Details
#### Endpoint
<p><kbd>/stacks/[stack&#95;uid]/server&#95;groups/[svg&#95;id]/servers/[uid].json</kbd></p>
#### Method
GET
#### Required Scope
public
#### Description
Returns the details of a single server
### Results
JSON object of the server:
<table class="table table-bordered table-striped">
	<thead>
		<tr>
			<th>Attribute</th>
			<th>Value</th>
			<th>Comments</th>
		</tr>
  </thead>
	<tbody>
		<tr><td>uid</td><td>Server uid</td><td></td></tr>
		<tr><td>vendor&#95;uid</td><td>Unique id used by the cloud vendor</td><td>BYOC only</td></tr>
		<tr><td>name</td><td>Server name</td><td></td></tr>
		<tr><td>address</td><td>Server address</td><td>This is the original server address given by the cloud vendor</td></tr>
		<tr><td>distro</td><td>Linux distro</td><td>Only ubuntu for now</td></tr>
		<tr><td>distro&#95;version</td><td>Linux distro version</td><td>Only 12.04 for now</td></tr>
		<tr><td>dns&#95;record</td><td>Server DNS record</td><td>Full c66.me dns record address</td></tr>
		<tr><td>user&#95;name</td><td>User name</td><td></td></tr>
		<tr><td>server&#95;type</td><td>Server Type</td><td>BYOS or "Cloud (vendor name)"</td></tr>
		<tr><td>params</td><td>Extra server parameters</td><td>See below</td></tr>
		<tr><td>created&#95;at</td><td>Record created at</td><td>Date Time in UTC</td></tr>
		<tr><td>updated&#95;at</td><td>Record updated at</td><td>Date Time in UTC</td></tr>
	</tbody>
</table>

##### Server Parameters

JSON object containing:
<table class="table table-bordered table-striped">
	<thead>
		<tr>
			<th>Attribute</th>
			<th>Value</th>
			<th>Comments</th>
		</tr>
  </thead>
	<tbody>
		<tr><td>size&#95;id</td><td>Server size id</td><td><a href="/help/instance_names">Server Sizes</a></td></tr>
		<tr><td>ips</td><td>All server IP addresses</td><td>JSON array of all IP addresses of the server</td></tr>
		<tr><td>aws&#95;security&#95;group</td><td>AWS Security group name</td><td>AWS Only</td></tr>
		<tr><td>region</td><td>Cloud vendor region</td><td><a href="/help/instance_regions">Region names</a></td></tr>
		<tr><td>availability&#95;zone</td><td>Cloud vendor availablity zone</td><td>AWS Only</td><td></td></tr>
	</tbody>
</table>

## Get Server Vital Signs History
#### Endpoint
<p><kbd>/stacks/[stack&#95;uid]/server&#95;groups/[svg&#95;id]/servers/[uid]/vital&#95;signs.json</kbd></p>
#### Method
GET
#### Required Scope
public
#### Description
Returns the vital signs history of a server. This is an array of CPU utilization and free disk and memory gathered from the server.
### Results
JSON object containing 3 arrays one for each vital sign.
<pre class="terminal">
{
	'Disk' : disk,
	'Memory' : memory,
	'CPU' : cpu
}
</pre>

Each array is as follows:

<pre class="terminal">
[{
	"ts" : UTC&#95;date&#95;time,
	"p" : data&#95;point&#95;value (utilized percentage)
	"m" : data&#95;point&#95;text (in English)
}]
</pre>

## Get Server Current Stats
#### Endpoint
<p><kbd>/stacks/[stack&#95;uid]/server&#95;groups/[svg&#95;id]/servers/[uid]/stats.json</kbd></p>
#### Method
GET
#### Required Scope
public
#### Description
Returns the current vital signs of a server.
### Results
JSON object containing 3 arrays one for each vital sign.
<pre class="terminal">
{
	'Disk' : disk,
	'Memory' : memory,
	'CPU' : cpu
}
</pre>

Each item is as follows:

<pre class="terminal">
{
	"ts" : UTC&#95;date&#95;time,
	"p" : data&#95;point&#95;value (utilized percentage)
	"m" : data&#95;point&#95;text (in English)
}
</pre>


## Notify Server IP Change
#### Endpoint
<p><kbd>/servers/[server&#95;uid]/force&#95;ip.json</kbd></p>
#### Method
POST
#### Required Scope
admin
#### Description
Notifies your stack of a server IP change. This can be changes in the internal or external IPv4 or IPv6 addresses. This notification will update all the DNS records related to the server as well. Also, if two servers share the same physical servers (like your web server and db server) the change will affect both.
Please note that this API call will try to change the IP address but the change is not guaranteed.
### Parameters
<table class="table table-bordered table-striped">
	<thead>
		<tr>
			<th>Attribute</th>
			<th>Value</th>
			<th>Comments</th>
		</tr>
  </thead>
	<tbody>
		<tr><td>int_ipv4</td><td>Internal IPv4 address</td><td>Optional</td></tr>
		<tr><td>int_ipv6</td><td>Internal IPv6 address</td><td>Optional</td></tr>
		<tr><td>ext_ipv4</td><td>External IPv4 address</td><td>Optional. If not provided, the IP address from the HTTP header of the API call is used</td></tr>
		<tr><td>ext_ipv6</td><td>External IPv6 address</td><td>Optional</td></tr>
	</tbody>
</table>
### Results
Success or failure and the list of the IP addresses.
<pre class="terminal">
{
	'ok' : true|false,
	'message' : text message about the change,
	'addresses' : list of the changed addresses
}
</pre>
